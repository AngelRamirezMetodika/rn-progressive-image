{"version":3,"names":["ProgressiveImage","smallSource","largeSource","style","initialBlurRadius","inEasing","Easing","bezier","outEasing","animationDuration","shimmerColors","athensGray","iron","shimmerDuration","withShimmer","loaded","setLoaded","useState","placeholderShouldRender","setPlaceholderShouldRender","largeOpacity","useSharedValue","placeholderOpacity","largeStyle","useAnimatedStyle","opacity","withTiming","value","duration","easing","placeholderStyle","useEffect","timeout","setTimeout","clearTimeout","BaseStyle","container","image","StyleSheet","absoluteFillObject","backgroundColor"],"sources":["index.tsx"],"sourcesContent":["// Packages\nimport React, { useEffect, useState } from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport Animated, {\n    useSharedValue,\n    useAnimatedStyle,\n    withTiming,\n    Easing,\n} from 'react-native-reanimated';\n\n// Components\nimport { ShimmerEffect } from './components/index';\n\n// Style\nimport BaseStyle from './style';\n\n// Constants\nimport { athensGray, iron } from './constants';\n\n// Props\nimport { ProgressiveImageProps } from './types';\n\nconst ProgressiveImage = ({\n    smallSource,\n    largeSource,\n    style,\n    initialBlurRadius,\n    inEasing = Easing.bezier(0.65, 0, 0.35, 1),\n    outEasing = Easing.bezier(0.65, 0, 0.35, 1),\n    animationDuration = 350,\n    shimmerColors = [athensGray, iron, athensGray],\n    shimmerDuration = 1000,\n    withShimmer,\n}: ProgressiveImageProps) => {\n    const [loaded, setLoaded] = useState(false);\n    const [placeholderShouldRender, setPlaceholderShouldRender] =\n        useState(true);\n\n    const largeOpacity = useSharedValue(0);\n    const placeholderOpacity = useSharedValue(1); // This is used for both the shimmerPlaceholder and the small image\n\n    const largeStyle = useAnimatedStyle(() => {\n        return {\n            opacity: withTiming(largeOpacity.value, {\n                duration: animationDuration,\n                easing: inEasing,\n            }),\n        };\n    });\n\n    const placeholderStyle = useAnimatedStyle(() => {\n        return {\n            opacity: withTiming(\n                placeholderOpacity.value,\n                {\n                    duration: animationDuration,\n                    easing: outEasing,\n                },\n                () => {\n                    if (loaded) {\n                        // This component no longer needs to be rendered, so we can dispose of it here.\n                        setPlaceholderShouldRender(false);\n                    }\n                },\n            ),\n        };\n    });\n\n    useEffect(() => {\n        if (loaded) {\n            largeOpacity.value = 1;\n\n            const timeout = setTimeout(\n                () => {\n                    placeholderOpacity.value = 0;\n                },\n                // Give this a slight delay so that we don't run\n                // into issues with flashes of empty content\n                animationDuration * 0.66,\n            );\n\n            // Cleanup function\n            return () => clearTimeout(timeout);\n        }\n\n        return;\n    }, [loaded]);\n\n    return (\n        <View style={[BaseStyle.container, style]}>\n            {placeholderShouldRender ? (\n                <Animated.View style={[BaseStyle.image, placeholderStyle]}>\n                    {smallSource ? (\n                        <Animated.Image\n                            style={{ ...StyleSheet.absoluteFillObject }}\n                            blurRadius={initialBlurRadius ?? 3}\n                            source={smallSource}\n                        />\n                    ) : withShimmer ? (\n                        <ShimmerEffect\n                            colors={shimmerColors}\n                            duration={shimmerDuration}\n                        />\n                    ) : (\n                        <View\n                            style={{\n                                ...StyleSheet.absoluteFillObject,\n                                backgroundColor: athensGray,\n                            }}\n                        />\n                    )}\n                </Animated.View>\n            ) : null}\n\n            <Animated.Image\n                style={[BaseStyle.image, largeStyle]}\n                onLoad={() => setLoaded(true)}\n                source={largeSource}\n            />\n        </View>\n    );\n};\n\nexport default ProgressiveImage;\n"],"mappings":"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"}