{"version":3,"names":["React","useEffect","useState","StyleSheet","View","Animated","useSharedValue","useAnimatedStyle","withTiming","Easing","ShimmerEffect","BaseStyle","athensGray","iron","ProgressiveImage","smallSource","largeSource","style","initialBlurRadius","inEasing","outEasing","animationDuration","shimmerColors","shimmerDuration","withShimmer","loaded","setLoaded","placeholderShouldRender","setPlaceholderShouldRender","largeOpacity","placeholderOpacity","largeStyle","opacity","value","duration","easing","bezier","placeholderStyle","timeout","setTimeout","clearTimeout","container","image","absoluteFillObject","backgroundColor"],"sources":["index.tsx"],"sourcesContent":["// Packages\nimport React, { useEffect, useState } from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport Animated, {\n    useSharedValue,\n    useAnimatedStyle,\n    withTiming,\n    Easing,\n} from 'react-native-reanimated';\n\n// Components\nimport { ShimmerEffect } from './components/index';\n\n// Style\nimport BaseStyle from './style';\n\n// Constants\nimport { athensGray, iron } from './constants';\n\n// Props\nimport { ProgressiveImageProps } from './types';\n\nconst ProgressiveImage = ({\n    smallSource,\n    largeSource,\n    style,\n    initialBlurRadius,\n    inEasing,\n    outEasing,\n    animationDuration = 350,\n    shimmerColors = [athensGray, iron, athensGray],\n    shimmerDuration = 1000,\n    withShimmer,\n}: ProgressiveImageProps) => {\n    const [loaded, setLoaded] = useState(false);\n    const [placeholderShouldRender, setPlaceholderShouldRender] =\n        useState(true);\n\n    const largeOpacity = useSharedValue(0);\n    const placeholderOpacity = useSharedValue(1); // This is used for both the shimmerPlaceholder and the small image\n\n    const largeStyle = useAnimatedStyle(() => {\n        return {\n            opacity: withTiming(largeOpacity.value, {\n                duration: animationDuration,\n                easing: inEasing ?? Easing.bezier(0.83, 0, 0.17, 1),\n            }),\n        };\n    });\n\n    const placeholderStyle = useAnimatedStyle(() => {\n        return {\n            opacity: withTiming(placeholderOpacity.value, {\n                duration: animationDuration,\n                easing: outEasing ?? Easing.bezier(0.83, 0, 0.17, 1),\n            }),\n        };\n    });\n\n    useEffect(() => {\n        if (loaded) {\n            largeOpacity.value = 1;\n            placeholderOpacity.value = 0;\n\n            const timeout = setTimeout(\n                () => {\n                    // After the animation has finished of the large\n                    // image, we can remove the placeholder. To do this,\n                    // we set our placeholderShouldRender state value to\n                    // false and this will trigger the unmount.\n                    setPlaceholderShouldRender(false);\n                },\n                // Give this a little extra time so we don't stack animations.\n                animationDuration + 100,\n            );\n\n            // Cleanup function\n            return () => clearTimeout(timeout);\n        }\n\n        return;\n    }, [loaded]);\n\n    return (\n        <View style={[BaseStyle.container, style]}>\n            {placeholderShouldRender ? (\n                <Animated.View style={[BaseStyle.image, placeholderStyle]}>\n                    {smallSource ? (\n                        <Animated.Image\n                            style={{ ...StyleSheet.absoluteFillObject }}\n                            blurRadius={initialBlurRadius ?? 3}\n                            source={smallSource}\n                        />\n                    ) : withShimmer ? (\n                        <ShimmerEffect\n                            colors={shimmerColors}\n                            duration={shimmerDuration}\n                        />\n                    ) : (\n                        <View\n                            style={{\n                                ...StyleSheet.absoluteFillObject,\n                                backgroundColor: athensGray,\n                            }}\n                        />\n                    )}\n                </Animated.View>\n            ) : null}\n\n            <Animated.Image\n                style={[BaseStyle.image, largeStyle]}\n                onLoad={() => setLoaded(true)}\n                source={largeSource}\n            />\n        </View>\n    );\n};\n\nexport default ProgressiveImage;\n"],"mappings":"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"}